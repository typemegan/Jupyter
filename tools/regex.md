# æ­£åˆ™è¡¨è¾¾å¼

æ–‡ä»¶åæ¨¡å¼ vs æ­£åˆ™è¡¨è¾¾å¼  
å­—ç¬¦ä¸²ä¸­çš„å…ƒå­—ç¬¦ vs æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„å…ƒå­—ç¬¦

**todo:**  

- Regex + Python  
- æ›´é«˜çº§çš„ç”¨æ³•

**é—®é¢˜:**

1. åœ¨ApacheæœåŠ¡å™¨çš„Rewriteè§„åˆ™ä¸­ï¼Œæ€æ ·ä»¥ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…â€œé™¤ä¸¤ä¸ªç‰¹å®šå­åŸŸåä¹‹å¤–çš„æ‰€æœ‰å…¶ä»–å­åŸŸåâ€œ
2. ä¿®å¤HTMLä¸­æœªé—­åˆçš„tag

[å‚è€ƒ](#reference)   
>
- [æ¦‚è¦](#general)
- [Tips](#tip)
	- [å¤æ‚æ€§ä¸å®Œæ•´æ€§ä¹‹é—´çš„æƒè¡¡](#easy)
	- [æ­£åˆ™è¡¨è¾¾å¼çš„å±€é™æ€§](#unable)
- [Regexçš„å…ƒå­—ç¬¦](#meta)
	- [é”šå®š](#location)  [^, $]
	- [å­—ç¬¦ç±»åˆ«](#classes) [., \w, \s]
	- [ç‰¹æ®Šç©ºç™½å­—ç¬¦](#white) [\n, \r]
	- [åŒ¹é…æ¬¡æ•°](#times)  [*,?]
		- [è´ªå©ªåŒ¹é…](#greedy) 
	- [å­—ç¬¦ç»„](#sets) [a-z]
	- [æ‹¬å·](#group) [æ‹¬å·çš„ç”¨å¤„]
		- [åå‘å¼•ç”¨](#reverse)
		- [åµŒå¥—åˆ†ç»„](#nest)
		- [æ•è·åˆ†ç»„](#capture)
		- [ä¸æ•è·åˆ†ç»„](#none-capture)
	- [è½¬ä¹‰ç¬¦](#escape) [\\]
- [ä¿®é¥°ç¬¦(Flags)](#flag)
- [å…¶ä»–è¯­è¨€/å·¥å…·ä¸­çš„å…ƒå­—ç¬¦ (æœ‰åˆ«äºRegex)](#other-meta)
	- [Shellä¸­çš„å…ƒå­—ç¬¦](#shell-meta)
	- [Perlä¸­çš„å…ƒå­—ç¬¦](#perl-meta)
- [å„è½¯ä»¶/ç¼–ç¨‹è¯­è¨€ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼](#tool)
	- [egrep](#egrep)
	- [perl](#perl)
		- [ä¸€è¡ŒPerlå‘½ä»¤](#one-line)
		- [ç›¸å…³è¯­æ³•](#perl-syntax)
- [ç¤ºä¾‹](#examples)
	- [æ‰¾å‡ºä»»æ„é‡å¤å•è¯](#repeate)
	- [åŒ¹é…åŒå¼•å·å†…çš„å­—ç¬¦ä¸²](#quote) [==å¾…è§£:å­—ç¬¦ä¸²å†…åŒ…å«\\"çš„æƒ…å†µ==]
	- [åŒ¹é…24å°æ—¶åˆ¶æ—¶é—´](#time)
	- [ä¿ç•™2ä½å°æ•°](#preserve)


## <a id='reference'>å‚è€ƒ</a>  
- [åœ¨çº¿å·¥å…·](https://regex101.com/) [python, golang, javascript, pcre(php)]
- [Regular expressions quick reference](https://www.computerhope.com/unix/regex-quickref.htm)
- [Computer Hope Regex](https://www.computerhope.com/jargon/r/regex.htm)
- [Python3.6: re â€” Regular expression operations](https://docs.python.org/3.6/library/re.html)
- [Rexegg](https://www.rexegg.com/)
- [Mastering Regular Expressions Errata](http://regex.info/errata3.html)

  
## <a id='general'>æ¦‚è¦   
ç±»ä¼¼æ–¹è¨€ï¼Œæ¯ç§å·¥å…·è¯­è¨€éƒ½åœ¨åŸºç¡€ä¸Šæœ‰è‡ªå·±çš„æ·»åŠ /æ”¹è¿› -->  **æµæ´¾(flavor)**  
å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼åŸºäºPerlçš„å…¼å®¹æ­£åˆ™è¡¨è¾¾å¼  
æ³¨æ„ï¼šæµæ´¾å’Œå·¥å…·æ˜¯2ä¸ªä¸åŒçš„æ¦‚å¿µï¼Œ2ä¸ªä¸åŒçš„å·¥å…·å¯èƒ½å±äºåŒæ ·çš„æµæ´¾ï¼›åå­—ç›¸åŒçš„å·¥å…·å¯èƒ½å±äºä¸åŒæµæ´¾ã€‚

æ­£åˆ™è¡¨è¾¾å¼ä¸æ˜“ç†è§£ï¼š  
1. è¡¨è¾¾å¼å†™æ³•ï¼šç´§å‡‘ï¼Œä¸æ˜“è¯»    
2. å„ç§è¯­è¨€çš„è¡¨è¾¾å¼è¯­æ³•ä¸ä¸€æ ·


## <a id='tip'>Tips
### <a id='easy'>å¤æ‚æ€§ä¸å®Œæ•´æ€§ä¹‹é—´çš„æƒè¡¡
>
å¯¹äº 12-33-90ï¼Œ12/33/90, 12.33.90  
regex1: `12.33.90`  
regex2: `12[-/.]33[-/.]90`   
éƒ½èƒ½åŒ¹é…ï¼Œä½†æ˜¾ç„¶regex2çš„åŒ¹é…ç²¾åº¦æ›´é«˜ï¼Œä½†ä¹Ÿæ›´å¤æ‚ï¼Œ  
regex1åˆ™ç®€å•æ˜“æ‡‚äº›ï¼Œä½†ä¼šåŒ¹é…é™¤æ­¤ä»¥å¤–çš„æƒ…å†µï¼Œe.g: 12033990  
å¯¹æ­¤ï¼Œ**éœ€è¦åœ¨å¯¹ç›®æ ‡æ–‡æœ¬çš„äº†è§£ç¨‹åº¦å’Œæ£€ç´¢çš„ç²¾ç¡®æ€§ä¹‹é—´å–å¾—å¹³è¡¡**   
å³ï¼šåŒ¹é…ç¬¦åˆè¦æ±‚çš„æ–‡æœ¬ï¼ŒåŒæ—¶å¿½ç•¥ä¸ç¬¦åˆè¦æ±‚çš„æ–‡æœ¬  
å¦‚æœæ¸…æ¥šæ–‡æœ¬ä¸ä¼šå‡ºç°é¢„æœŸä¹‹å¤–çš„æƒ…å†µï¼Œåˆ™ä½¿ç”¨regex1å°±å¯ä»¥äº†  

### <a id='unable'>æ­£åˆ™è¡¨è¾¾å¼çš„å±€é™æ€§
è§ç”¨ä¾‹:['æ‰¾å‡ºä»»æ„é‡å¤å•è¯'](#repeate)

   
## <a id='meta'>Regexçš„å…ƒå­—ç¬¦(Standard Regex)   
**å…ƒå­—ç¬¦(metacharacter) / å…ƒå­—ç¬¦åºåˆ—(metasequences)**:  ä¸€ä¸ªå­—ç¬¦æˆ–å­—ç¬¦ç»„åˆï¼Œé¢„ç•™ï¼Œç±»ä¼¼äºç¼–ç¨‹è¯­è¨€ä¸­å…³é”®å­—ï¼Œè¡¨ç¤ºæŸä¸€æ“ä½œï¼Œe.g. \nè¡¨ç¤ºæ¢æ–°è¡Œ, ^è¡¨ç¤ºä»è¡Œé¦–å¼€å§‹ã€‚è¦å°†å…ƒå­—ç¬¦ä½œä¸ºæ™®é€šå­—ç¬¦ä½¿ç”¨ï¼Œéœ€è¦'\'å¯¹å…¶è¿›è¡Œè½¬ä¹‰ã€‚

**æ™®é€šå­—ç¬¦**: éå…ƒå­—ç¬¦ï¼Œæ³¨æ„ï¼šç©ºæ ¼ä¹Ÿæ˜¯æ™®é€šå­—ç¬¦

### <a id='location'>é”šå®š(Anchors and Boundaries)
>
å…ƒå­—ç¬¦ | æ„ä¹‰ | è¯´æ˜
------|-----|----
^ | ä»è¡Œé¦–å¼€å§‹
$ | ä»è¡Œå°¾å¼€å§‹
\b | å•è¯è¾¹ç•Œ | ing\b, åŒ¹é…å•è¯çš„æœ«å°¾çš„ingï¼› \bhe, åŒ¹é…å•è¯é¦–çš„he
\B | éå•è¯è¾¹ç•Œ | \Bing\B, åŒ¹é…éå•è¯é¦–å°¾éƒ¨åˆ†çš„ing
\\< | åŒ¹é…å•è¯é¦– | Pythonä¸æ”¯æŒ, egrepæ”¯æŒ
\\> | åŒ¹é…å•è¯å°¾ | Pythonä¸æ”¯æŒ, egrepæ”¯æŒ	
`(?=...)` | é¡ºåºç¯è§†(positive lookahead)ï¼Œä»å·¦å¾€å³æŸ¥çœ‹æ–‡æœ¬ | `abc(?=xyz)`: åŒ¹é…abc,abcåè·Ÿç€xyzï¼ŒæŒ‡å‘xä¹‹å‰çš„ä½ç½®ï¼›ç±»ä¼¼`(?:...)`åˆ†ç»„ä½†ä¸æ•è·ï¼Œ`(?=...)`å®šä½ä½†ä¸ä½œä¸ºåŒ¹é…ç»“æœ
`(?<=...)` | é€†åºç¯è§†(negative lookahead),ä»å³å¾€å·¦æŸ¥çœ‹æ–‡æœ¬

#### é¡ºåºç¯è§†
>![](../imgs/regex_lookahead.png)

### <a id='classes'>å­—ç¬¦ç±»åˆ«(Character Classes)
>
å…ƒå­—ç¬¦ | æ„ä¹‰ | è¯´æ˜
---|---|---
. | åŒ¹é…é™¤newline[^newline]çš„ä»»æ„å­—ç¬¦ | Pythonä¸­newlineçš„å…ƒå­—ç¬¦ä¸º'\n'
\d | åŒ¹é…æ•°å­—ï¼Œç›¸å½“äº`[0-9]`
\D | éæ•°å­—ï¼Œå³`[^0-9]`
\s | åŒ¹é…ç©ºå­—ç¬¦(space, tab, form feed,ç­‰) 
\S | åŒ¹é…éç©ºå­—ç¬¦
\w | åŒ¹é…å•è¯å­—ç¬¦ï¼šå­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿ï¼Œ ç­‰åŒäº[a-zA-Z0-9_]
\W | åŒ¹é…éå•è¯å­—ç¬¦ | åŒ…æ‹¬\så’Œéƒ¨åˆ†\S

### <a id='white'>ç‰¹æ®Šç©ºç™½ç¬¦
>
å…ƒå­—ç¬¦ | æ„ä¹‰ | è¯´æ˜
-----| -----|-----
\n | a newline 
\t | a tab
\r | å›è½¦é”®[^cr] | ä¸åŒäºnewline
\v | a vertical tab
\f | a form feed, è¿›çº¸ç¬¦
\b | é€€æ ¼ç¬¦

### <a id='times'>åŒ¹é…æ¬¡æ•°(Quantifiers)
>
å…ƒå­—ç¬¦ | æ„ä¹‰ | è¯´æ˜
---  | ---- | ----
\* | åŒ¹é…ä¹‹å‰çš„å­—ç¬¦0æ¬¡ä»¥ä¸Š | è´ªå©ªåŒ¹é…ï¼Œca*t, è¡¨ç¤ºåŒ¹é…c+a+tç»„åˆï¼Œå…¶ä¸­aå¯æœ‰å¯æ— ï¼Œæœ‰çš„è¯å¯ä»¥ä»»æ„å¤šä¸ªï¼Œct, cat, caat, caaaat
\+ | åŒ¹é…ä¹‹å‰çš„å­—ç¬¦1æ¬¡ä»¥ä¸Š 
? | å¯é€‰é¡¹å…ƒç´ ï¼ŒåŒ¹é…ä¹‹å‰çš„å­—ç¬¦0æ¬¡æˆ–1æ¬¡ | éè´ªå©ªåŒ¹é…
{m} | åŒ¹é…mæ¬¡ | Pythonä¸­ä¸éœ€'\'è½¬ä¹‰'{'ï¼Œç›´æ¥{m}å³å¯
{m, n} | åŒ¹é…m~næ¬¡ | Python: {m, n}
{m,} | åŒ¹é…è‡³å°‘mæ¬¡ | Python: {m, }

#### <a id='greedy'>è´ªå©ªåŒ¹é…ï¼š
```
*?, +?, ??   
The '*', '+', and '?' qualifiers are all greedy; they match as much text as possible. 
Sometimes this behaviour isnâ€™t desired; 
if the RE <.*> is matched against '<a> b <c>', 
it will match the entire string, and not just '<a>'. 
Adding ? after the qualifier makes it perform the match in non-greedy or minimal fashion;
as few characters as possible will be matched. 
Using the RE <.*?> will match only '<a>'.
```

e.g. åŒ¹é…HTMLçš„tagæ ‡ç­¾<xxx>ï¼š   
`<.*>` ä¼šåŒ¹é… `<I>short</I>` è€Œä¸å•å•æ˜¯`<I>`å’Œ`</I>`,  
å› ä¸º`.*`ä¼šè¿›è¡Œè´ªå©ªåŒ¹é…

### <a id='sets'>å­—ç¬¦ç»„(Charater Sets and Ranges)
> **æ³¨ï¼šåœ¨å­—ç¬¦ç»„å†…éƒ¨å’Œå¤–éƒ¨ï¼Œå…³äºå…ƒå­—ç¬¦çš„è§„å®šæ˜¯ä¸åŒçš„ï¼Œ   
> e.g.ç‚¹å·'.'åœ¨å­—ç¬¦ç»„å†…ä¸ºæ™®é€šå­—ç¬¦ï¼Œåœ¨å­—ç¬¦ç»„å¤–ä¸ºå…ƒå­—ç¬¦ï¼ˆä»£è¡¨é™¤newlineå¤–çš„ä»»æ„å­—ç¬¦ï¼‰**
>
å…ƒå­—ç¬¦ | æ„ä¹‰ | è¯´æ˜
---- | ---- | ----
[å­—ç¬¦ç»„] | åŒ¹é…ä»»ä¸€åœ¨å­—ç¬¦ç»„ä¸­çš„å­—ç¬¦ |  [abcd], åŒ¹é…ä»»ä¸€ä¸ºabcdå…¶ä¸€çš„å­—ç¬¦
[^...] | æ’é™¤å‹å­—ç¬¦ç»„ï¼ŒåŒ¹é…ä»»ä¸€ä¸å±äºå­—ç¬¦ç»„çš„å­—ç¬¦ | [^abcd], åŒ¹é…ä»»ä¸€ä¸ä¸ºabcdçš„å­—ç¬¦ï¼›[^0-9]ï¼ŒåŒ¹é…é™¤æ•°å­—ä»¥å¤–çš„å­—ç¬¦ï¼›**æ³¨æ„: æ’é™¤å‹å­—ç¬¦ç»„è¡¨ç¤ºå¿…é¡»åŒ¹é…ä¸€ä¸ªæœªåˆ—å‡ºçš„å­—ç¬¦ï¼Œè€Œä¸æ˜¯ä¸åŒ¹é…ï¼›æ­¤å¤„çš„==è„±å­—ç¬¦â€˜^â€™==(ç´§è·Ÿåœ¨å­—ç¬¦ç»„ç¬¬ä¸€ä¸ªæ–¹æ‹¬å·å)è¡¨ç¤ºæ’é™¤ï¼Œä¸åŒäºå­—ç¬¦ç»„å¤–è¡¨ç¤ºè¡Œå¼€å¤´**
[å­—ç¬¦x-å­—ç¬¦xx] | åŒ¹é…ä»»ä¸€åœ¨xã€xxå­—ç¬¦ä¹‹é—´çš„å­—ç¬¦ | å­—ç¬¦èŒƒå›´ç”±ASCIIè¡¨[^ascii]å®šï¼Œ[a-z], [0-9]; å¦‚æœèŒƒå›´æ— æ•ˆï¼Œåˆ™åŒ¹é…å¤±è´¥ï¼Œx, -, xxéƒ½ä¸ä¼šå†ä½œä¸ºæ™®é€šå­—ç¬¦è¿›è¡ŒåŒ¹é…ï¼›**æ­¤å¤„çš„==è¿å­—ç¬¦'-'==è¡¨ç¤ºèŒƒå›´ï¼Œå…¶ä»–æƒ…å†µä»ä¸ºæ™®é€šå­—ç¬¦(å­—ç¬¦ç»„å†…é¦–ä½ï¼Œå­—ç¬¦ç»„å†…ç´§è·Ÿåœ¨'[^'åï¼Œå­—ç¬¦ç»„å¤–)ï¼Œå­—ç¬¦ç»„å†…å¦‚è¦åŒ¹é…è¿å­—ç¬¦ï¼Œåˆ™éœ€å°†è¿å­—ç¬¦æ”¾åœ¨å­—ç¬¦ç»„çš„é¦–ä½**
reg1\|reg2 | å¤šé€‰ç»“æ„ï¼Œæˆ–æ“ä½œåŒ¹é…reg1æˆ–reg2 | abc\|xyz, åŒ¹é…abcæˆ–xyz; å¯ä»¥é€šè¿‡æ‹¬å·æ¥é™åˆ¶å¤šé€‰ç»“æ„çš„èŒƒå›´ï¼šc(a\|e)fï¼ŒåŒ¹é…cafæˆ–cef


### <a id='group'>æ‹¬å·:é™åˆ¶/åˆ†ç»„/æ•è·(Group and Capture)
> **æ‹¬å·çš„ä½œç”¨**:  
> 1. **é™åˆ¶å¤šé€‰ç»“æ„**: `gr(a|e)y`  
> 2. **åˆ†ç»„**: å°†æ‹¬å·å†…çš„è¡¨è¾¾å¼ä½œä¸ºä¸€ä¸ªæ•´ä½“(å­—ç¬¦)å¯¹å¾…ï¼Œæ‹¬å·å†…çš„è¡¨è¾¾å¼å¯ä»¥ä»»æ„å¤æ‚, `(hello)*`åŒ¹é…helloä»»æ„å¤šæ¬¡  
> 3. **åå‘å¼•ç”¨(æ•è·)**: æ•è·/å¼•ç”¨åˆ†ç»„åŒ¹é…çš„å†…å®¹ï¼Œæ•è·è®¡æ•°åŒæ‹¬å·è‡ªå·¦å‘å³å‡ºç°çš„é¡ºåº,`([a-z])([0-9])\1\2` \1å¼•ç”¨[a-z]åŒ¹é…çš„å†…å®¹ï¼Œ\2å¼•ç”¨[0-9]åŒ¹é…çš„å†…å®¹   

å…ƒå­—ç¬¦ | æ„ä¹‰ | è¯´æ˜
---- |  --- | ----
(...) | åˆ†ç»„å¹¶æ•è· | Pythonä¸­ä¸éœ€å¯¹()è¿›è¡Œè½¬ä¹‰; (ab){3}ï¼Œè¿ç»­åŒ¹é…ab3æ¬¡
(?:...) | åªåˆ†ç»„ä¸æ•è· | Python: (?...); (ab)cd(?:ef), åŒ¹é…abcdef, è®°abä¸ºæ•è·ä¸€ï¼Œefä¸è®¡å…¥æ•è·   

<a id='reverse'>åå‘å¼•ç”¨(perl)ï¼š</a>  
> é™·é˜±ï¼šåœ¨åŸæœ‰åŸºç¡€ä¸Šå¢åŠ æ‹¬å·ï¼Œä¼šæ‰“ç ´åŸæœ‰å¼•ç”¨å˜é‡çš„ç¼–å·ï¼Œè§£å†³:[ä¸æ•è·åˆ†ç»„](#none-capture)
>![](../imgs/regex_capture.png)
    
<a id='nest'>åµŒå¥—åˆ†ç»„ï¼š</a>
>![](../imgs/regex_nest_capture.png)

<a id='capture'>æ•è·åˆ†ç»„ï¼š</a>  
>![](../imgs/regex_group_capture.png)

<a id='none-capture'>ä¸æ•è·åˆ†ç»„ï¼š</a>
>![](../imgs/regex_none_group_capture.png)
    
### <a id='escape'>è½¬ä¹‰ç¬¦
> è½¬ä¹‰ç¬¦==åæ–œçº¿'\'==å¯ä»¥å°†å…ƒå­—ç¬¦è½¬æ¢æˆæ™®é€šå­—ç¬¦ï¼Œe.g. \., åŒ¹é…ç‚¹   
> è½¬ä¹‰ç¬¦æœ¬èº«ä¹Ÿæ˜¯å…ƒå­—ç¬¦ï¼Œéœ€è¦å¯¹è‡ªèº«è¿›è¡Œè½¬ä¹‰æ‰èƒ½åŒ¹é…è‡ªèº«ï¼Œ\\\
> è½¬ä¹‰ç¬¦åœ¨å­—ç¬¦ç»„ä¸­æ— æ•ˆ 


[^newline]: newlineå…ƒå­—ç¬¦è¡¨ç¤ºä¸€è¡Œçš„ç»“æŸå’Œæ–°ä¸€è¡Œçš„å¼€å§‹ï¼Œåœ¨ç¼–ç¨‹è¯­è¨€ä¸­newlineç”¨'\n'è¡¨ç¤º
[^cr]: [å›è½¦é”® carriage return](https://www.computerhope.com/jargon/c/cr.htm)
[^ascii]: [ASCIIè¡¨](https://www.computerhope.com/jargon/a/ascii.htm)


## <a id='flag'>ä¿®é¥°ç¬¦(Flags)
> æ”¾åœ¨æ­£åˆ™è¡¨è¾¾å¼çš„æœ«å°¾ï¼Œç”¨äºè¡¥å……   
> **æ³¨æ„ï¼šè¯¥åŠŸèƒ½ä¸æ˜¯æ­£åˆ™è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†**
> 
å­—ç¬¦ | æ„ä¹‰
--- | ---
i | å¿½ç•¥å¤§å°å†™
m | å¤šè¡ŒåŒ¹é…
s | åŒ¹é…æ–°è¡Œ
x | å…è®¸ç©ºæ ¼å’Œæ³¨é‡Š
J | å…è®¸é‡å¤çš„ç»„å
U | éè´ªå©ªæ¨¡å¼


## <a id='other-meta'>å…¶ä»–è¯­è¨€/å·¥å…·ä¸­çš„å…ƒå­—ç¬¦ (æœ‰åˆ«äºRegex)</a>
### <a id='shell-meta'>Shellä¸­çš„å…ƒå­—ç¬¦</a>
> ç©ºæ ¼ç¬¦æ˜¯å…ƒå­—ç¬¦ï¼Œç”¨æ¥åˆ†éš”å‘½ä»¤ã€å‚æ•°  
> å•å¼•å·æ˜¯å…ƒå­—ç¬¦ï¼Œå¼•å·å†…çš„å­—ç¬¦ä¸è¢«å½“ä½œå…ƒå­—ç¬¦  
> åŒå¼•å·ä¸­çš„`$ * ?`ä»è§†ä½œå…ƒå­—ç¬¦ï¼Œæ‰€ä»¥å˜é‡å¯ä»¥åœ¨åŒå¼•å·ä¸­å¼•ç”¨`â€œ$varâ€`  

### <a id='perl-meta'>Perlä¸­çš„å…ƒå­—ç¬¦</a>
> `\b`ï¼šé€€æ ¼ç¬¦

# <a id='tool'>å„è½¯ä»¶/ç¼–ç¨‹è¯­è¨€ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼ </a>
## <a id='egrep'>Egrep
> egrepç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…æ¯ä¸ªæ–‡ä»¶çš„æ¯ä¸€è¡Œï¼Œå¹¶æ˜¾ç¤ºåŒ¹é…çš„ç»“æœï¼›  
> **egrepåœ¨åŒ¹é…å‰ä¼šå°†æ¯ä¸€è¡Œæœ«å°¾çš„æ¢è¡Œç¬¦å»æ‰ï¼›**  
> **å±€é™æ€§ï¼šegrepå°†æ¯è¡Œæ–‡å­—å½“åšä¸€ä¸ªç‹¬ç«‹éƒ¨åˆ†çœ‹å¾…ï¼Œå¦‚æœè¦åŒ¹é…çš„å¯¹è±¡åˆ†æˆäº†2è¡Œï¼Œåˆ™æ— æ³•åŒ¹é…**
![](../imgs/egrep_cmd.png)
> å¿½ç•¥å¤§å°å†™: `$ egrep -i 'regex' files`

## <a id='perl'>Perl
>Perl æ˜¯ä¸€é—¨è§£é‡Šå‹è¯­è¨€(è„šæœ¬è¯­è¨€)ï¼Œå…·æœ‰å¼ºå¤§çš„æ–‡æœ¬å¤„ç†åŠŸèƒ½ï¼›  
æ‰§è¡ŒPerlä»£ç ï¼Œå¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­é€šè¿‡perlè§£é‡Šå™¨: $ perl è„šæœ¬ï¼Œ  
æˆ–è€…åœ¨å‘½ä»¤è¡Œä¸­æŒ‡å®šä»£ç æ‰§è¡Œ $ perl -e â€˜ä»£ç â€™ --> **Perl-one Liners**  
ç»“åˆPerl-one Liners + å…¶å†…éƒ¨æ”¯æŒçš„å¼ºå¤§Regexï¼Œå¯ä»¥ä¸€è¡Œå‘½ä»¤å°±æ‰§è¡Œå„ç§æ–‡æœ¬å¤„ç†   
  
ğŸ”[Linux perl command overview](https://www.computerhope.com/unix/uperl.htm)  
ğŸ”[Perl-one Liners](https://www.rexegg.com/regex-perl-one-liners.html)  


### <a id='one-line'>ä¸€è¡ŒPerlå‘½ä»¤(Perl-one Liners, æ­£åˆ™åŒ¹é…/æ›¿æ¢/åˆ†å‰²</a>

`perl  -e 'print "hello"'`  
`$ perl -e 'code' file1 file2 ...`  
`$ echo $filepath | perl -e 'code'`

> å‘½ä»¤å‚æ•°ï¼š  
> -e 'perl code': æŒ‡å®šè¦æ‰§è¡Œçš„perlä»£ç   
> -n: å°†fileæ–‡ä»¶å†…å®¹é€è¡Œè¾“ç»™ä»£ç æ‰§è¡Œ  
> -0777: å°†æ¢è¡Œç¬¦æ›¿æ¢æˆundefï¼Œå³å°†æ–‡ä»¶å†…å®¹ä¸€æ¬¡æ€§è¾“ç»™ä»£ç   
> -i: æ›¿æ¢æ–‡ä»¶å†…å®¹ï¼Œå°†è¾“å‡ºå†™å…¥åŸæ–‡ä»¶   
> -p: é€è¡Œå¤„ç†æ–‡ä»¶ï¼Œå¹¶æ‰“å°è¾“å‡º   
> -w: å¼€å¯æœ‰ç”¨çš„è­¦å‘Š  
> -W: å¼€å¯æ‰€æœ‰çš„è­¦å‘Š
> 
> ä»£ç ç”¨å•å¼•å·åŒ…å›´ï¼Œå¦‚æœä»£ç ä¸­åŒ…å«å•å¼•å·ï¼Œä¸è¦ç”¨è½¬ä¹‰ç¬¦ï¼Œå»ºè®®å°†åŒ…å«å¼•å·çš„éƒ¨åˆ†å•ç‹¬æå–å‡ºæ¥åšç¯å¢ƒå˜é‡ï¼Œå†åœ¨ä»£ç ä¸­å¼•ç”¨ï¼Œe.g.:  
> `env mypattern="'\w+"`           
> `perl -0777 -ne 'while(m/$ENV{mypattern}/g){print "$&\n";}' yourfile`

å¸¸ç”¨å‘½ä»¤ï¼š  
ğŸ‘‰`perl -i -pe 's/A/a/g' file`   
å°†fileé‡Œçš„å¤§å†™å­—æ¯Aå…¨éƒ¨æ¢æˆaï¼Œå¹¶å†™å›åŸæ–‡ä»¶ 
 
ğŸ‘‰`perl -pe 's/.\/imgs/..\/imgs/g' iterator.ipynb |grep imgs`   
æµ‹è¯•: å°†'./imgs'å…¨å±€æ›¿æ¢æˆ'../imgs'çš„ç»“æœï¼Œgrepè¿‡æ»¤è¾“å‡ºï¼Œåªæ˜¾ç¤ºåŒ…å«imgsçš„è¡Œ

### <a id='perl-syntax'>ç›¸å…³çš„è¯­æ³•</a>
`=~`: åŒ¹é…ç¬¦

 `m/regex/`: å¯¹æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…æ“ä½œ 

`m/regex/i`: åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ï¼Œä¸åŒºåˆ†å¤§å°å†™

`s/regex/relacement/`: å°†åŒ¹é…å†…å®¹æ›¿æ¢æˆreplacement  

`s/regex/replacement/i`: ä¸åŒºåˆ†å¤§å°å†™è¿›è¡ŒåŒ¹é…ï¼ŒåŒ¹é…å†…å®¹æ›¿æ¢æˆreplacement, iå¯¹æ›¿æ¢å†…å®¹æ— å½±å“  

`s/regex/replacement/g`: å…¨å±€æ›¿æ¢ï¼Œå®Œæˆç¬¬ä¸€æ¬¡æ›¿æ¢åç»§ç»­æœç´¢æ›´å¤šæ–‡æœ¬è¿›è¡ŒåŒ¹é…æ›¿æ¢
>
```perl   
if ($reply =~ m/^[0-9]$/):   
	print "only digits\n"    
else:  
	print "not only digits\n"  
```

`$var = <>` é€è¡Œè¯»å…¥æ•°æ®èµ‹ç»™ $var  
>
```perl
while ($line=<>) {  
	#process with line
}
```

`defined($var)` æ£€æŸ¥ä¸€ä¸ªå˜é‡æ˜¯å¦è®¾äº†å€¼  
`die "...."` å‘å‡ºé”™è¯¯ä¿¡æ¯ï¼Œé€€å‡ºç¨‹åº

## <a id='examples'>ç¤ºä¾‹</a>
![](../imgs/regex_example_email.png)  

Regex | æ„ä¹‰
---   | ---
`^$`  | åŒ¹é…è¡Œå¼€å¤´ç„¶åæ˜¯è¡Œæœ«å°¾ --> åŒ¹é…ç©ºè¡Œï¼ˆæ²¡æœ‰ä»»ä½•å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºå­—ç¬¦ï¼‰
`^\s*$` | åŒ¹é…ç©ºè¡Œï¼Œå¹¶å…è®¸å¸¦ä»»æ„ç©ºå­—ç¬¦
`[a-zA-Z_][a-zA-Z_0-9]{0,31}` | åŒ¹é…æ ‡ç¤ºç¬¦(å˜é‡å)ï¼Œé•¿åº¦ä¸è¶…è¿‡32ä½  
`\(([^()]+)\)` | åŒ¹é…æ‹¬å·çš„å†…å®¹
`s/^/|> /` <sub>perlæ›¿æ¢</sub>  | åœ¨è¡Œé¦–æ’å…¥`|> `
`<\b>http[s]?://[^\s]+\.htm[l]?<\b>` | åŒ¹é…HTTP/HTML URL, ç‰¹ç‚¹:urlä¸­ä¸å­˜åœ¨ç©ºæ ¼


### <a id='repeate'>âœï¸æ‰¾å‡ºä»»æ„é‡å¤å•è¯ï¼Œe.g: word wordï¼Œåº”ç”¨åœºæ™¯:æ£€æŸ¥é‡å¤è¾“å…¥
`\b([a-zA-Z]+) +\1\b`  
>å±€é™æ€§ï¼š  
1. å¦‚æœé‡å¤çš„å•è¯åˆ†è¡Œå†™ï¼Œåœ¨ä¸€äº›å·¥å…·/ç¼–ç¨‹è¯­è¨€ï¼ˆæ¯”å¦‚egrepï¼‰ä¸­æ— æ³•åŒ¹é…ï¼›  
2. å¹¶ä¸æ˜¯æ‰€æœ‰çš„é‡å¤è¾“å…¥éƒ½æ˜¯è¯­æ³•é”™è¯¯ï¼Œæ¯”å¦‚ that that, åœ¨æ­¤åŸºç¡€éœ€è¦äººå·¥ä»‹å…¥å†åˆ¤æ–­

### <a id='quote'>âœï¸åŒ¹é…åŒå¼•å·å†…çš„å­—ç¬¦ä¸²  
>
1ã€å­—ç¬¦ä¸²ä¸åŒ…å«åŒå¼•å·çš„æƒ…å†µï¼š  
`"[^"]*"` åŒ¹é…åŒå¼•å·å†…é™¤å¼•å·ä¹‹å¤–çš„å­—ç¬¦ä»»æ„æ¬¡   

> 2ã€å­—ç¬¦ä¸²ä¸­åŒ…å«åŒå¼•å·çš„æƒ…å†µ(å¸¦\è½¬ä¹‰)ï¼Œe.g.: "what about \\"x4\\"?"


### <a id='time'>âœï¸åŒ¹é…24å°æ—¶åˆ¶æ—¶é—´ </a>
```
24å°æ—¶åˆ¶çš„èŒƒå›´ï¼š  
[0-9]:[0-5][0-9]
0[0-9]:[0-5][0-9]
1[0-9]:[0-5][0-9]
2[0-3]:[0-5][0-9]

æå–å…¬å…±éƒ¨åˆ†ï¼š
å°æ—¶ï¼š[01]?[0-9] å’Œ 2[0-3]
-> ([01]?[0-9]|2[0-3]):[0-5][0-9]

æˆ–è€…å°æ—¶éƒ¨åˆ†çš„è¿˜å¯ä»¥çœ‹åšï¼š
[0-3],[4-9]
0[0-3],[4-9]
1[0-3],[4-9]
2[0-3]
æå–å…¬å…±éƒ¨åˆ†ï¼š
-> ([0-2]?[0-3]|[01]?[4-9]):[0-5][0-9]
```

### <a id='preserve'>âœï¸ä¿ç•™2ä½å°æ•°</a>
> ä»·æ ¼æ˜¾ç¤ºï¼Œä»æµ®ç‚¹æ•°ä¸­ä¿ç•™2ä½å°æ•°ï¼Œä¸ç”¨å››èˆäº”å…¥   
> å¦‚æœå°æ•°ç‚¹åç¬¬ä¸‰ä½ä¸ä¸ºé›¶ï¼Œåˆ™ä¹Ÿéœ€ä¿ç•™  

> `s/(\.\d\d[1-9]?)\d*/$1/g`  
> åªä¿ç•™åŒ¹é…åˆ°çš„åˆ†ç»„ï¼Œåˆ†ç»„å¤–åŒ¹é…çš„æ•°å­—èˆå¼ƒ

